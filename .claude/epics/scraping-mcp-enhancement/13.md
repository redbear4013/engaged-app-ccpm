---
name: Core Infrastructure & Orchestrator
status: open
created: 2025-10-01T01:34:04Z
updated: 2025-10-01T01:34:04Z
github: https://github.com/redbear4013/engaged-app-ccpm/issues/13
depends_on: []
parallel: true
conflicts_with: []
---

# Task: Core Infrastructure & Orchestrator

## Description

Build the foundational orchestration layer for the automated scraping system. This includes GitHub Actions workflows for scheduled execution, the core orchestrator framework with in-process concurrency control, circuit breaker for fault tolerance, and intelligent tool selection between Firecrawl and Chrome DevTools MCP.

## Acceptance Criteria

- [ ] GitHub Actions workflows created for 2-hour and 4-hour cadences
- [ ] Orchestrator framework supports in-process concurrency control
- [ ] Circuit breaker implementation tracks failures and implements exponential backoff
- [ ] Tool selector intelligently routes between Firecrawl (priority) and Chrome DevTools MCP (fallback)
- [ ] Configuration loader reads and validates config/sources.json
- [ ] Error handling and logging integrated throughout
- [ ] Workflow triggers manual execution option for testing

## Technical Details

- **Implementation approach**:
  - GitHub Actions workflows using cron syntax for scheduling
  - Orchestrator as TypeScript class managing execution lifecycle
  - Circuit breaker pattern with state persistence in Supabase
  - Tool selector evaluates source complexity and selects appropriate scraping tool
  - Configuration schema validation using Zod or similar

- **Key considerations**:
  - Prevent concurrent runs of same workflow (use concurrency groups)
  - Handle workflow timeouts gracefully (max 6 hours for GitHub Actions free tier)
  - Circuit breaker state must persist across workflow runs
  - Tool fallback logic: Firecrawl fails → Chrome DevTools → Mark source as degraded
  - Rate limiting across all sources to respect target servers

- **Code locations/files affected**:
  - `.github/workflows/scrape-priority-1.yml` (2-hour cadence)
  - `.github/workflows/scrape-priority-2.yml` (4-hour cadence)
  - `src/services/orchestrator/orchestrator.ts`
  - `src/services/orchestrator/circuit-breaker.ts`
  - `src/services/orchestrator/tool-selector.ts`
  - `src/services/orchestrator/config-loader.ts`
  - `config/sources.json`

## Dependencies

- [ ] Supabase client configured for database access
- [ ] Firecrawl MCP server accessible
- [ ] Chrome DevTools MCP server accessible
- [ ] Environment variables for API keys and secrets

## Effort Estimate

- Size: L
- Hours: 20-24
- Parallel: true

## Definition of Done

- [ ] Code implemented and follows project conventions
- [ ] Unit tests written and passing (>80% coverage)
- [ ] Integration tests for orchestrator workflow
- [ ] Circuit breaker behavior tested with fault injection
- [ ] Tool selector fallback logic verified
- [ ] Configuration schema documented
- [ ] GitHub Actions workflows tested with manual triggers
- [ ] Error scenarios logged appropriately
- [ ] Code reviewed and approved
- [ ] Merged to main branch
